{
  "code": "Certainly! Below is a Python function that validates email addresses using a regular expression. The regex used here aims to cover common valid email formats, but keep in mind that email validation with regex can be complex, and this is a practical approach for most applications.\n\n### Secure Email Validation Function\n\n```python\nimport re\n\ndef is_valid_email(email: str) -> bool:\n    \"\"\"\n    Validates an email address using regex.\n\n    Args:\n        email (str): The email address to validate.\n\n    Returns:\n        bool: True if the email is valid, False otherwise.\n    \"\"\"\n    if not isinstance(email, str):\n        # Reject non-string inputs immediately\n        return False\n\n    # Basic RFC-compliant email regex pattern\n    email_regex = re.compile(\n        r\"^(?P<local>[\\w.!#$%&'*+/=?^`{|}~-]+)\"\n        r\"@\"\n        r\"(?P<domain>[A-Za-z0-9](?:[A-Za-z0-9-]{0,61}[A-Za-z0-9])?\"\n        r\"(?:\\.[A-Za-z0-9](?:[A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*\\.?)$\"\n    )\n\n    match = email_regex.fullmatch(email)\n    if match:\n        # Additional checks can be added here if necessary\n        return True\n    return False\n```\n\n### Usage example\n\n```python\nprint(is_valid_email(\"test@example.com\"))  # True\nprint(is_valid_email(\"invalid-email\"))     # False\n```\n\n### Notes:\n- The function first checks if the input is a string to prevent unexpected errors.\n- The regex pattern is designed to match standard email formats according to RFC 5322, but less complex and more practical for most validation needs.\n- You can extend or customize this pattern depending on the specific email formats you wish to accept.\n- Remember that regex validation does not guarantee that the email address exists or can receive emails; it only confirms proper formatting.\n\n### Additional Security Tips:\n- Avoid exposing detailed validation errors that could aid malicious actors.\n- For critical systems, consider verifying email addresses through confirmation emails.\n- Always handle user input carefully and sanitize data if used elsewhere in your application."
}